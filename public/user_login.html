<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8" />
		<title>登录</title>
		<link rel="stylesheet" href="css/user_login.css" />
	<body>
		<div class="header">
			<h2>手机商城</h2>
		</div>
		<div class="loginbg">
			<a class='Login' href=""></a>
			<div class="loginBox">
				<h4>账号登录</h4>
				<input id="uname" type="text" placeholder="请输入用户名" autofocus>
				<input id="upwd" type="password" placeholder=" 请输入密码">
				<div class="success2"></div>
				<button id="button" >
					<a href="javascript:login()">登录</a>
				</button>
				<div class="div-a">
					<a href="user_register.html">注册账号</a>
				</div>
			</div>
		</div>
		<footer>
			<h4>
				© 20015 - 2019 FYY 版权所有 豫ICP备08160823号-1 | 隐私政策 | 用户使用协议 | 联系方式：4001-888-888
			</h4>
		</footer>

		<script>
			var uname=document.getElementById("uname");
			var upwd=document.getElementById("upwd");
			var btn=document.getElementById("button");
			var div=btn.previousElementSibling;
			uname.onfocus=upwd.onfocus=function(){
				div.innerHTML="";
			}
			function login(){
				
					//1.创建异步对象
					var xhr=new XMLHttpRequest();
//				console.log('11111');
					//2.绑定监听
					xhr.onreadystatechange=function(){
						if(xhr.readyState==4 && xhr.status==200){
							var result=xhr.responseText;
							console.log(result);
							
							if(result==1){
								div.style.color="#2ad181";
								div.innerHTML="欢迎登陆";
								setTimeout(function () {
									window.location.href ='index.html';
								},2000);
								//获取用户输入的用户名
								var u=uname.value;
								//保存sessionStorage
								sessionStorage.setItem("uname",u);
							}else{
								div.style.color="red";
								div.innerHTML='账号或密码错误'
							}
						}
					}
					//3.打开连接，创建请求
					xhr.open('post','/user/login',true);
					xhr.setRequestHeader('Content-type','application/x-www-form-urlencoded');
					var formhtml='uname='+uname.value+'&upwd='+upwd.value;
					console.log(formhtml);
					//4.发送请求
					xhr.send(formhtml);
					console.log('5555');

			}

		</script>
	</body>
</html>
